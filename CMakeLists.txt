CMAKE_MINIMUM_REQUIRED(VERSION 2.6)

PROJECT(ANKI_PROJ)

IF(${CMAKE_SYSTEM_NAME} STREQUAL Linux)
	ADD_DEFINITIONS("-DPLATFORM_LINUX")
ELSEIF(${CMAKE_SYSTEM_NAME} STREQUAL Windows)
	ADD_DEFINITIONS("-DPLATFORM_WINDOWS")
ENDIF()

FIND_PACKAGE(Subversion)
IF(Subversion_FOUND)
	Subversion_WC_INFO(${CMAKE_CURRENT_SOURCE_DIR} ER)
	ADD_DEFINITIONS("-DREVISION=${ER_WC_REVISION}")
ELSE()
	ADD_DEFINITIONS("-DREVISION=???")
ENDIF()

ADD_DEFINITIONS("-DMATH_INTEL_SIMD -DGLEW_MX -pedantic-errors -pedantic -ansi -Wall -Winline -W -Wwrite-strings -Wno-unused -Wno-long-long -msse4")

# Add a few compiler specific stuff 
IF(${CMAKE_CXX_COMPILER} MATCHES ".*clang\\+\\+$")	
	# Do nothing
ELSE()
	ADD_DEFINITIONS("-fsingle-precision-constant")
ENDIF()

IF(CMAKE_BUILD_TYPE STREQUAL Debug)
	ADD_DEFINITIONS("-D_GLIBCXX_DEBUG -D_GLIBXX_DEBUG_PEDANTIC")
ELSE()
	ADD_DEFINITIONS("-DBOOST_DISABLE_ASSERTS -mtune=core2 -ffast-math")
ENDIF()


INCLUDE_DIRECTORIES("${ANKI_PROJ_SOURCE_DIR}/extern/include")
INCLUDE_DIRECTORIES("${ANKI_PROJ_SOURCE_DIR}/extern/include/bullet") # Because bullet wants it
INCLUDE_DIRECTORIES("/usr/include/python2.6")
INCLUDE_DIRECTORIES("/usr/include/freetype2")
INCLUDE_DIRECTORIES(.)

LINK_DIRECTORIES(${ANKI_PROJ_SOURCE_DIR}/extern/lib64)

# Lib dependencied
FIND_PACKAGE(Boost 1.46 REQUIRED)
FIND_PACKAGE(PNG 1.2 REQUIRED)
FIND_PACKAGE(JPEG 62 REQUIRED)
FIND_PACKAGE(Freetype 2.4.4 REQUIRED)
FIND_PACKAGE(PythonLibs 2.6 REQUIRED)

ADD_SUBDIRECTORY(anki)
ADD_SUBDIRECTORY(testapp)
